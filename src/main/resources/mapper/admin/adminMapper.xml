<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.acorn.doma.mapper.AdminMapper">

    <!-- 공지사항 목록 조회 -->
    <select id="getNotices" parameterType="Search" resultType="Admin">
        SELECT *
        FROM d_board
        WHERE div = '20'
        <if test="searchWord != null and searchWord != ''">
            AND title LIKE CONCAT('%', #{searchWord}, '%')
        </if>
        ORDER BY reg_dt DESC
    </select>

    <!-- 공지사항 등록 -->
    <insert id="insertNotice" parameterType="Admin">
        INSERT INTO d_board (seq, div, title, user_id, mod_id, content, img_link, reg_dt, mod_dt, views, gname)
        VALUES (d_board_seq.NEXTVAL, '20', #{title}, #{userId}, #{modId}, #{content}, #{imgLink}, SYSDATE, SYSDATE, #{views}, #{gname})
    </insert>




    <!-- 공지사항 수정 -->
    <update id="updateNotice" parameterType="Admin">
        UPDATE d_board
        SET title = #{title},
            user_id = #{userId},
            mod_id = #{modId},
            content = #{content},
            img_link = #{imgLink},
            mod_dt = SYSDATE,
            views = #{views},
            gname = #{gname}
        WHERE seq = #{seq} AND div = '20'
    </update>


    <!-- 공지사항 삭제 -->
<delete id="deleteNotice" parameterType="Admin">
    DELETE FROM d_board
    WHERE seq = #{seq} AND div = '20'
</delete>


    <!-- 공지사항 단건 조회 -->
    <select id="getNoticeById" parameterType="int" resultType="Admin">
        SELECT seq AS seq, div AS div, title AS title, user_id AS userId, mod_id AS modId, content AS content, img_link AS imgLink, reg_dt AS regDt, mod_dt AS modDt, views AS views, gname AS gname
        FROM d_board
        WHERE seq = #{seq} AND div = '20'
    </select>



    <!-- 회원 목록 조회 -->
    <select id="getUsers" parameterType="Search" resultType="Admin">
        SELECT *
        FROM d_user
        <if test="searchWord != null and searchWord != ''">
            WHERE user_name LIKE CONCAT('%', #{searchWord}, '%')
        </if>
        ORDER BY user_reg_dt DESC
    </select>

    <!-- 회원 수정 -->
    <update id="updateUser" parameterType="Admin">
        UPDATE d_user
        SET user_name = #{userName},
            user_pw = #{userPw},
            user_email = #{userEmail},
            user_birth = #{userBirth},
            user_grade = #{userGrade},
            user_address = #{userAddress},
            user_detail_address = #{userDetailAddress}
        WHERE user_id = #{userId}
    </update>

    <!-- 회원 삭제 -->
    <delete id="deleteUser" parameterType="Admin">
        DELETE FROM d_user
        WHERE user_id = #{userId}
    </delete>

    <!-- 회원 단건 조회 -->
    <select id="getUser" parameterType="Admin" resultType="Admin">
        SELECT *
        FROM d_user
        WHERE user_id = #{userId}
    </select>

</mapper>
