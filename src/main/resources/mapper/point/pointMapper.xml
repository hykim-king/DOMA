<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.acorn.doma.mapper.PointMapper">

	<insert id="dataInsert" parameterType="Point">
		INSERT INTO D_POINT (
			point_id,
			acc_point, 
			accident, 
			dead, 
			seriously, 
			ordinary, 
			report, 
			point_type,
			longitude,
			latitude,
			year,
			gname
		) 
		VALUES (
			#{pid}, 
			#{accPoint}, 
			#{accdient}, 
			#{dead}, 
			#{seriously}, 
			#{ordinary}, 
			#{report}, 
			#{pointType}, 
			#{longitude}, 
			#{latitude},
			#{year},
			#{gname}
		)
	</insert>
	
	<select id="fullTableScan" resultType="Point">
		select
		    year,
		    sum(accident) as accdient,
		    sum(dead) as dead,
		    sum(seriously) as seriously,
		    sum(ordinary) as ordinary,
		    sum(report) as report
		  from d_point
		group by year
		order by year desc
	</select>
	
	<delete id="doDeleteAll">
	    DELETE FROM D_POINT
	</delete>
	
	<select id="countAll" resultType="int">
	    SELECT COUNT(*) FROM D_POINT
	</select>

</mapper>